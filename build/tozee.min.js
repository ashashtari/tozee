/*! tozee 0.1.2 2015-06-30 */
(function(t){if("function"==typeof define&&define.amd)define(["$"],t);else{var e=window.Mobify&&window.Mobify.$||window.Zepto||window.jQuery;t(e)}})(function(t){var e=function(){}(t),o=function(t){var e={alphaSet:["#","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],minLetterHeight:24,skipLetters:!0,classPrefix:"m-",classNames:{outer:"tozee",list:"tozee__list",bar:"tozee__bar",item:"tozee__item",letter:"tozee__letter",sticky:"-stick"}},o=function(t,e){this.setOptions(e),this.initElements(t),this.createBar(),this.formatLetters(),this.bind()};return o.defaults=e,o.prototype.setOptions=function(o){var i=this.options||t.extend({},e,o);o&&(i.classNames=t.extend({},i.classNames,o.classNames||{})),this.options=i},o.prototype.initElements=function(e){return this.$element=t(e),this.$element.length?(this.$list=this.$element.find("."+this._getClass("list")),this.$items=this.$list.children(),this.$bar,void 0):!1},o.prototype.createBar=function(){var e=this,o='<ul class="'+this._getClass("bar")+'">';t.each(this.options.alphaSet,function(t,i){(!e.options.skipLetters&&"#"!==i||e._getTarget(i).length)&&(o+='<li class="'+e._getClass("letter")+'"  data-tozee="'+i+'">'+i+"</li>")}),o+="</ul>",this.$bar=t(o),this.$bar.appendTo(this.$element)},o.prototype.formatLetters=function(){var e=this.$bar.find("."+this._getClass("letter"));this.$bar.css({height:window.innerHeight});var o=this.$bar.height(),i=Math.ceil(this.options.minLetterHeight*e.length/o);t.each(e,function(o,s){var n=t(s);n.prop("hidden",o>0&&e.length-1>o&&0!==o%i)});var s=100/e.not("[hidden]").length;e.css({height:s+"%"}),this.$bar.toggleClass("m--short",i>1)},o.prototype.bind=function(){this._bindTouch(),this._bindSroll(),this._bindResize()},o.prototype._bindTouch=function(){var t=this;this.$bar.on("click touchstart touchmove",function(e){e.preventDefault();var o=t._getTouchedLetter(e);if(!o||!o.length)return!1;var i=o.closest("."+t._getClass("letter")).attr("data-tozee");return i&&t._callback(i),!1})},o.prototype._bindSroll=function(){var e=this;t(window).on("scroll touchmove",function(){e._scrollHandler()}),this._scrollHandler()},o.prototype._bindResize=function(){var e=this;t(window).on("orientationchange resize",function(){e.formatLetters()})},o.prototype._scrollHandler=function(){var t=window.pageYOffset,e=this._getScrollLimits(),o=this._getClass("sticky");e.top>t?this.$bar.removeClass(o).css({top:0,bottom:"auto"}):t>e.bottom&&e.bottom>e.top?this.$bar.removeClass(o).css({top:"auto",bottom:0}):this.$bar.addClass(o).css({top:0,bottom:0})},o.prototype._callback=function(t){var e=this._getTarget(t),o=this.options.alphaSet.indexOf(t);if(!e.length){for(;!e.length&&o>=0;)o--,e=this._getTarget(this.options.alphaSet[o]);for(;!e.length&&this.options.alphaSet.length>o;)o++,e=this._getTarget(this.options.alphaSet[o]);if(!e.length)return console.log("TOZEE","Could not find target for letter",t),!1}var i=e.offset().top,s=this._getScrollLimits();i>s.bottom&&(i=s.bottom),this.$element.trigger("tozeeScroll",t,e),this._scrollTo(i)},o.prototype._getClass=function(t){return this.options.classPrefix+this.options.classNames[t]},o.prototype._getScrollLimits=function(){return{top:this.$element.offset().top,bottom:this.$element.offset().top+this.$element.height()-this.$bar.height()}},o.prototype._getTarget=function(t){return this.$list.find('[data-tozee="'+t+'"]').first()},o.prototype._getTouchedLetter=function(e){var o,i=e.touches||e.originalEvent&&e.originalEvent.touches;return i?(o=t(document.elementFromPoint(i[0].pageX-window.pageXOffset,i[0].pageY-window.pageYOffset)),o.length||(o=t(document.elementFromPoint(i[0].pageX,i[0].pageY)))):o=t(e.target),o&&o.length?(console.log("TOZEE",e.touches,o.html()),o):!1},o.prototype._scrollTo=function(t){window.scrollTo(0,t)},o.prototype.destroy=function(){this.$bar.remove()},o}(t,e);t.fn.tozee=function(e,i){var s=t.extend({},t.fn.tozee.defaults);return"object"==typeof e&&(t.extend(s,e,!0),i=null,e=null),i=Array.prototype.slice.apply(arguments),this.each(function(){var n=(t(this),this._tozee);n||(n=new o(this,s)),e&&(n[e].apply(n,i.slice(1)),"destroy"===e&&(n=null)),this._tozee=n}),this},t.fn.tozee.defaults={}});